<!DOCTYPE html>
<html lang="en" dir="ltr">
    <header>
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
        <!-- <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-purple.min.css"> -->
        <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.purple-indigo.min.css" />
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
        <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="/JS/getmdl/getmdl-select.min.css"/>
        <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
        <script defer src="/JS/getmdl/getmdl-select.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
        <title>Talent Development</title>
    </header>
    <body>
        <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
            <header class="mdl-layout__header">
                <div class="mdl-layout__header-row">
                    <!-- Title -->
                    <span class="mdl-layout-title">TALENT DEVELOPMENT</span>
                    <!-- Add spacer, to align navigation to the right -->
                    <div class="mdl-layout-spacer"></div>
                    <!-- Navigation. We hide it in small screens. -->
                </div>
                </header>
            <%- include ("partials/navTemplate.ejs"); -%>
            <main class="mdl-layout__content">
                <div class="page-content">
                    <div class="mdl-grid" style="width: 95%; margin-top: 20px;" id="group_list">
                        <!-- <div class="mdl-card mdl-shadow--4dp">
                            <div class="mdl-card__title" style="background-image: url('../Assets/Employee/Avatar/193286.jpg'); background-size: 350px; background-repeat: no-repeat; width: 350px; height: 200px; overflow: hidden;">
                            </div>
                            <div class="mdl-card__supporting-text">
                                <div style="color: red; font-size: 20px; margin-bottom: 10px;">LE QUANG DUNG</div>
                                <div class="mdl-grid" style="padding: 0;">
                                    <i class="material-icons" style="color: indigo;">credit_card</i>
                                    <div style="margin-top: 3px; margin-left: 10px; color: black;">ID: 193286</div>
                                </div>
                                <div class="mdl-grid" style="padding: 0; margin-top: 10px;">
                                    <i class="material-icons" style="color: green;">location_on</i>
                                    <div style="margin-top: 3px; margin-left: 10px; color: black; word-wrap: break-word;">Pos: Senior Lean and Innovation Enginner</div>
                                </div>
                                <div class="mdl-grid" style="padding: 0; margin-top: 10px;">
                                    <i class="material-icons" style="color: orangered;">credit_card</i>
                                    <div style="margin-top: 3px; margin-left: 10px; color: black;">Dept: Enginner</div>
                                </div>
                            </div>
                            <div class="mdl-card__menu">
                                <button class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                                  <i class="material-icons">more_vert</i>
                                </button>
                            </div>
                        </div>
                    </div> -->
                    
                </div>
            </main>
        </div>
        <dialog style="width: 90%; padding: 0; border: none; background-color: transparent;" id="dialog_profile">
            <div class="mdl-grid" style="padding: 0;">
                <div class="mdl-grid" style="margin: 10px auto; width: 100%; height: 80vh; background-color: transparent;">
                    <embed id="pdf_talent" width="100%" height="100%" style="margin: 10px auto;"/>
                    <!-- src="../Assets/HR/NVXS&TTXS_2020.pdf" -->
                </div>
            </div>
            <!-- <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" 
                id="btn_close_dialog" style="position: absolute; top: 20px; right: 20px;">
                <i class="material-icons">close</i>
                Close
            </button> -->
            <button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored" 
                id="btn_close_dialog" style="background-color: red; color: white;position: absolute; top: 10px; right: 10px;">
                <i class="material-icons">close</i>
            </button>
        </dialog>
    </body>
    <script>
        init();
        function imageExists(image_url){
            console.log(image_url);
            var http = new XMLHttpRequest();
            http.open('HEAD', image_url, false);
            http.send();
            return http.status != 404;
        }
        function init(){
            group_list=document.getElementById('group_list');
            var xsend= new XMLHttpRequest();
            xsend.open("POST","/HR/Load_Employee_Talent",true);
            xsend.onreadystatechange= function(){
                if (this.readyState==4 && this.status==200) {
                    result=JSON.parse(xsend.responseText);
                    console.log(result)
                    // group_infor=[]
                    // while (group_list.childNodes.length>0) group_list.removeChild(group_list.childNodes[0])
                    for (var i=0; i<result.length; i++){
                        // group_infor.push(result[i]);
                        grid_element=document.createElement('div');
                        // grid_element.setAttribute('class', 'mdl-cell mdl-cell--2-col');
                        grid_element.setAttribute('style', 'width: 350px; margin-top: 20px;');
                        card=document.createElement('div');
                        card.setAttribute("class","mdl-card mdl-shadow--4dp");
                        // card.setAttribute("style","background-color: HoneyDew; width: 200px; margin: 20px auto; boder-radius: 10px; overflow: visible;");
                        header=document.createElement('div');
                        header.setAttribute("class", "mdl-card__title");
                        
                        header.style.backgroundImage="url('../Assets/Employee/Avatar/"+result[i].EmpID+".jpg')";
                        header.style.backgroundSize="350px";
                        header.style.backgroundRepeat="no-repeat";
                        header.style.width="350px";
                        header.style.height="200px";
                        header.style.overflow="hidden";
                        //body
                        body=document.createElement('div');
                        body.setAttribute('class', 'mdl-card__supporting-text');
                        divName=document.createElement('div');
                        divName.setAttribute('style', 'color: red; font-size: 20px; margin-bottom: 10px;');
                        divName.innerHTML=result[i].Name;
                        //ID
                        divGridID=document.createElement('div');
                        divGridID.setAttribute('class', 'mdl-grid');
                        divGridID.setAttribute('style', 'padding: 0');
                        iconID=document.createElement('i');
                        iconID.setAttribute('style','color: indigo;');
                        iconID.setAttribute('class', 'material-icons');
                        iconID.innerHTML='credit_card'
                        divID=document.createElement('div');
                        divID.setAttribute('style', 'margin-top: 3px; margin-left: 10px; color: black;');
                        divID.innerHTML=result[i].EmpID;
                        componentHandler.upgradeElement(iconID);
                        divGridID.appendChild(iconID);
                        divGridID.appendChild(divID)
                        componentHandler.upgradeElement(divGridID);
                        //Position
                        divGridPosition=document.createElement('div');
                        divGridPosition.setAttribute('class', 'mdl-grid');
                        divGridPosition.setAttribute('style', 'padding: 0; margin-top:10px;');
                        iconPosition=document.createElement('i');
                        iconPosition.setAttribute('style','color: green;');
                        iconPosition.setAttribute('class', 'material-icons');
                        iconPosition.innerHTML='location_on'
                        divPosition=document.createElement('div');
                        divPosition.setAttribute('style', 'margin-top: 3px; margin-left: 10px; color: black;');
                        divPosition.innerHTML=result[i].Position;
                        divGridPosition.appendChild(iconPosition);
                        divGridPosition.appendChild(divPosition)
                        //Department
                        divGridDept=document.createElement('div');
                        divGridDept.setAttribute('class', 'mdl-grid');
                        divGridDept.setAttribute('style', 'padding: 0; margin-top:10px;');
                        iconDept=document.createElement('i');
                        iconDept.setAttribute('style','color: orangered;');
                        iconDept.setAttribute('class', 'material-icons');
                        iconDept.innerHTML='settings'
                        divDept=document.createElement('div');
                        divDept.setAttribute('style', 'margin-top: 3px; margin-left: 10px; color: black;');
                        divDept.innerHTML=result[i].Dept;
                        divGridDept.appendChild(iconDept);
                        divGridDept.appendChild(divDept);
                        
                        body.appendChild(divName)
                        body.appendChild(divGridID)
                        body.appendChild(divGridPosition)
                        body.appendChild(divGridDept);
                        //footer
                        footer=document.createElement('div');
                        footer.setAttribute('class', 'mdl-card__menu');
                        button=document.createElement('button');
                        button.setAttribute('class', 'mdl-button mdl-js-button mdl-button--icon');
                        button.id='btn_more_'+i;
                        var icon=document.createElement("i");
                        icon.setAttribute("class", "material-icons");
                        icon.setAttribute("style", "color: white;")
                        icon.innerHTML="more_vert";
                        // componentHandler.upgradeElement(icon);
                        button.appendChild(icon);
                        // componentHandler.upgradeElement(button);
                        var ul=document.createElement("ul");
                        ul.setAttribute("class", "mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect");
                        ul.setAttribute("for", 'btn_more_'+i);
                        ul.innerHTML='<li class="mdl-menu__item" style="color: Green;" onclick="fnc_view(this)"><i class="material-icons" style="vertical-align: middle; margin-right: 10px;">folder</i>PROFILE</li>';
                        ul.innerHTML+='<li class="mdl-menu__item" style="color:Red;"   onclick="fnc_asslot_pending(this)"><i class="material-icons" style="vertical-align: middle; margin-right: 10px;">edit</i>EVALUATE</li>';
                        componentHandler.upgradeElement(button);
                        componentHandler.upgradeDom('MaterialMenu', 'mdl-menu');
                        footer.appendChild(button);
                        footer.appendChild(ul);
                        componentHandler.upgradeElement(header);
                        componentHandler.upgradeElement(body);
                        componentHandler.upgradeElement(footer);
                        card.appendChild(header);
                        card.appendChild(body);
                        card.appendChild(footer);
                        componentHandler.upgradeElement(card);
                        grid_element.appendChild(card);
                        componentHandler.upgradeElement(grid_element);
                        group_list.appendChild(grid_element);
                    }
                }
            }
            xsend.setRequestHeader("Content-type", "application/json");
            data={year: '2020'}
            xsend.send(JSON.stringify(data));
        }
        function fnc_view(x){
            console.log(x.parentNode.parentNode.parentNode.parentNode.childNodes[1].childNodes[1].childNodes[1].innerHTML);
            empID=x.parentNode.parentNode.parentNode.parentNode.childNodes[1].childNodes[1].childNodes[1].innerHTML;
            if (imageExists("../Assets/Employee/TalentDevelopment/"+empID+'_2020.pdf'))
            document.getElementById('pdf_talent').src='../Assets/Employee/TalentDevelopment/'+empID+'_2020.pdf';
            embedElement=document.getElementById('pdf_talent');
            parentElement=embedElement.parentNode;
            document.getElementById('pdf_talent').remove();
            parentElement.appendChild(embedElement)
            document.getElementById('dialog_profile').showModal();
        }
        document.getElementById('btn_close_dialog').addEventListener('click', function(){
            document.getElementById('dialog_profile').close();
        })
    </script>
</html>